#cloud-config
	ssh_pwauth: no
	users:
	  - name: user
	    sudo: ALL=(ALL) NOPASSWD:ALL
	    shell: /bin/bash
	    ssh-authorized-keys:
	    - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDbSex48HfkdXuqTvwK3QTIWOrt6Ag9fWt26Z0WFoyn6cexV+mPG+ne7/jyBkEWI9AG/j7G+epzHwnkpbxO0bR20xl4YXrfSTvPb2mKI5tMZUfisO7H3kfCsllgeJL0t/vRe22rMpb7oC6ayBHI2OZ6qJ3vsC4qq2ej3d8n41SQrKD48I/4mGymYC4pLow7o4G7/oa//6F6AHNWrJQig7mz6eJ07b+T7i8AW1+CupwA01gGNQTf8kltRrXd5NAapZkDfzMSpMeG4BJfx3V++P6chD/YEO5PsRr+VAwDkxugFzhv7rW6jVMD0iANfrbfR4Xw/iXO4O+qgd/F7NXgkyWQAdv0epXisDYuQItqd5+sQA3OceaDMlMH0sW5JyHJTebvGGVW86LhTanBS/PWvw05XdxwlTS5kT3pmrr6j85uXwIBMw1udvJT30I0Sv0MP/CGHlyMb97mUioWhSoX2Izda8n+HC3ohuroIVOXat4Zzi3hW8L87IF54AEJSEr8X4SUy5JSE01JHLLQ4fbzG6OBMSpDBZsQDdaOhKCajvhKTOT8TpXt/GJ2vhvA/AXH18uoVXwld4aFefgrEc5dbpZ3ndPoCwcPs4qRasjeGlbX0wI6PrSU0RyXNwRsvofxsks8qbEiT0/USzQ2t4fg8eBoUJN7HssRc4dT23z5uqtS6w=="
	write_files:
	  - content: |
        #!/bin/bash
        apt update
        apt install -y \
          ca-certificates \
          curl \
          gnupg \
          lsb-release

        install -m 0755 -d /etc/apt/keyrings
        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg
        echo \
          "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
          $(lsb_release -cs) stable" | tee /etc/apt/sources.list.d/docker.list > /dev/null

        apt update
        apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

        usermod -aG docker user
      path: "/root/vm_prep.sh"
      permissions: "0740"
	
	runcmd:
	  - [ bash, /root/vm_prep.sh ]